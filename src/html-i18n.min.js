function i18n_translate(a,b,c){if("array"==typeof a){const c=[];b=!!b;for(const d of a)c.push(i18n_translate(d,b));return c}var d,e,f,g,h;const i=(chrome||msBrowser||browser).i18n||null,j="data-i18nhtml",k="",l="innerText",m="innerHTML",n=a=>"Missing translation \""+a+"\"",o=i?["Title","Alt","Value"]:null,p="string"==typeof a,q=p&&b||!p&&c,r=p?a:null,s=p?null:{},t=c=>{e=c.hasAttribute(j),f=c.getAttribute("data-i18ninfo"),g=i.getMessage(d=c.getAttribute(e?j:"data-i18ntext")),g!=k&&b||(s[d]={message:c[e?m:l],description:f,html:e,attr:null,missing:g==k}),g==k||a||(c[e?m:l]=g),q&&g==k&&console.log(n(d),c);for(const e of o)c.hasAttribute(e)&&(g=i.getMessage(h=d+e),g!=k&&b||(s[h]={message:c.getAttribute(e),description:null==f?null:f+" ("+e+")",html:!1,attr:e.toLowerCase(),missing:g==k}),g==k||a||c.setAttribute(e,g),q&&g==k&&console.log(n(h),c))};if(!i)return p?"":s;if(p){const a=i.getMessage(r);return q&&a==k&&(console.warn(n(r)),console.trace()),a}if(a instanceof HTMLElement){const d=a;return a=!1,c=!!b,b=!1,t(d),s}for(const d of document.querySelectorAll("*[data-i18ntext],*[data-i18nhtml]"))t(d);return s}